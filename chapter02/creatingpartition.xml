<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-partitioning-creatingpartition">
  <?dbhtml filename="creatingpartition.html"?>

  <title>Создание нового раздела</title>

  <para>Как и большинство других операционных систем, LFS обычно устанавливается
  на выделенный раздел. Рекомендуемый подход к построению системы LFS состоит в
  том, чтобы использовать доступный пустой раздел или, если у вас достаточно
  неразмеченного пространства, использовать его</para>

  <para>Минимальная система требует раздел размером около 10 гигабайт (ГБ).
  Этого достаточно для хранения всех архивов с исходным кодом и компиляции
  пакетов. Однако, если система LFS предназначена для использования в качестве
  основной системы Linux, вероятно, будет установлено дополнительное программное
  обеспечение, для которого потребуется дополнительное пространство. Раздел
  размером 30 ГБ является разумным размером для расширения. Сама система LFS
  не займет столько места. Большая часть этого требования заключается в
  предоставлении достаточного временного хранилища, а также в добавлении
  дополнительных возможностей после сборки LFS. Кроме того, для компиляции
  пакетов может потребоваться много места на диске, которое будет освобождено
  после установки пакета.</para>

  <para>Поскольку для компиляции не всегда достаточно оперативной памяти (ОЗУ),
  рекомендуется использовать небольшой раздел диска в качестве
  <systemitem class="filesystem">раздела подкачки</systemitem>. Он используется
  ядром для хранения редко используемых данных и оставляет больше памяти для
  активных процессов. <systemitem class="filesystem">Раздел подкачки</systemitem>
  для системы LFS может совпадать с разделом, используемым хост-системой, и в
  этом случае нет необходимости создавать еще один.</para>

  <para>Запустите программу создания разделов диска, такую как <command>cfdisk</command>
  или <command>fdisk</command>, с параметром командной строки, указав имя
  жесткого диска, на котором будет создан новый раздел, например,
  <filename class="devicefile">/dev/sda</filename> для основного диска.
  Создайте раздел Linux и
  <systemitem class="filesystem">раздел подкачки</systemitem>, если это
  необходимо. Пожалуйста, обратитесь к справке  
  <ulink role='man' url='&man;cfdisk.8'>cfdisk(8)</ulink> или 
  <ulink role='man' url='&man;fdisk.8'>fdisk(8)</ulink>, если вы еще не знаете, 
  как пользоваться этими программами.</para>

  <note><para>Для опытных пользователей возможны и другие схемы разбиения.
  Система LFS может располагаться на программном <ulink
  url="&blfs-book;postlfs/raid.html">RAID-массиве</ulink> или логическом
  томе <ulink
  url="&blfs-book;postlfs/aboutlvm.html">LVM</ulink>. Однако для некоторых
  опций требуется <ulink
  url="&blfs-book;postlfs/initramfs.html">initramfs</ulink>, что является
  сложной темой. Эти методы разбиения не рекомендуются начинающим пользователям
  LFS.</para></note>

  <para>Запомните обозначение созданного раздела (например, 
  <filename class="devicefile">sda5</filename>). В этой книге он будет
  называться разделом LFS. Также запомните обозначение 
  <systemitem class="filesystem">раздела подкачки</systemitem>. Эти имена
  понадобятся позже для файла <filename>/etc/fstab</filename>.</para>

  <sect2>
  <title>Другие вопросы по созданию разделов</title>

  <para>Рекомендации по созданию разделов системы часто публикуются в списках
  рассылки LFS. Это очень субъективная тема. По умолчанию для большинства
  дистрибутивов используется весь диск, за исключением небольшого раздела
  подкачки. Это не оптимально для LFS по нескольким причинам. Это снижает
  гибкость, затрудняет совместное использование данных между несколькими
  дистрибутивами или сборками LFS, делает резервное копирование более
  трудоемким и может тратить дисковое пространство из-за неэффективно
  распределенной файловой системы.</para>

    <sect3>
    <title>Корневой раздел</title>

    <para>Корневой раздел LFS (не путать с каталогом
	<filename class="directory">/root</filename>) размером в 20 гигабайт
	является хорошим компромиссом для большинства систем. Он обеспечивает
	достаточно места для построения LFS и большей части BLFS, но
	достаточно мал, чтобы можно было легко создать несколько разделов для
	экспериментов.</para> </sect3>

    <sect3>
    <title>Раздел подкачки</title>

    <para>Большинство дистрибутивов автоматически создают раздел подкачки.
	Обычно рекомендуемый размер раздела подкачки примерно в два раза превышает
	объем физической памяти, однако это требуется редко. Если дисковое
	пространство ограничено, установите размер раздела подкачки в два гигабайта
	и контролируйте его объемом.</para>

    <para>Если вы хотите использовать режим гибернации (suspend-to-disk)
	Linux, которая записывает содержимое ОЗУ в раздел подкачки перед выключением
	машины. Установите размер раздела подкачки не меньше объема установленной
	оперативной памяти.</para>

    <para>Использование файла подкачки - это не очень хорошо. Для механических
	жестких дисков вы можете определить, что система использует раздел подкачки,
	просто слыша активность диска и наблюдая, как система реагирует на команды.
	Для SSD-накопителя вы не сможете услышать, что используется раздел подкачки,
	но сможете оценить, сколько места на разделе подкачки занято, используя команды
	<command>top</command> или <command>free</command>. По возможности следует
	избегать использования SSD-накопителя для раздела подкачки. Первой реакцией на
	активность раздела подкачки должна быть проверка на необоснованное применение
	какой-либо команды, например, попытка редактирования пятигигабайтного файла.
	Если использование раздела подкачки становится обычным явлением, лучшее 
	решение — приобретение большего объема оперативной памяти для вашей системы.</para>
	</sect3>

    <sect3>
    <title>Раздел GRUB</title>

    <para>Если <emphasis>загрузочный диск</emphasis> размечен с помощью
	таблицы разделов GUID (GPT), необходимо создать небольшой раздел, обычно
	размером 1 МБ, если он еще не существует. Этот раздел не форматируется,
	но должен быть доступен для использования GRUB во время установки загрузчика.
	Обычно он помечен как 'BIOS Boot' при использовании
	<command>fdisk</command> или имеет код <emphasis>EF02</emphasis> при
	использовании <command>gdisk</command>.</para>

    <note><para>Раздел Grub Bios должен находиться на диске, который BIOS
	использует для загрузки системы. Это не обязательно тот же диск, на
	котором расположен корневой раздел LFS. Диски в системе могут использовать
	разные типы таблиц разделов. Наличие раздела Grub Bios зависит только от
	типа таблицы разделов на загрузочном диске.</para></note>
    </sect3>

    <sect3>
    <title>Разделы, используемые для удобства</title>

    <para>Есть несколько других разделов, которые не являются обязательными, но
	их следует учитывать при разработке схемы диска. Следующий список не
	является исчерпывающим, а представлен в качестве справочного руководства.</para>

    <itemizedlist>

      <listitem><para>/boot &ndash; Настоятельно рекомендуется. Используйте этот
	  раздел для хранения ядер и другой загрузочной информации. Чтобы свести к
	  минимуму возможные проблемы с загрузкой дисков большого размера, сделайте
	  этот раздел первым физическим разделом на первом диске. Размер раздела в
	  200 мегабайт вполне достаточен.</para></listitem>

      <listitem><para>/boot/efi &ndash; Системный раздел EFI, используемый для
	  загрузки системы с помощью UEFI. Подробнее читайте на
	  <ulink url="&blfs-book;postlfs/grub-setup.html">странице BLFS</ulink>.</para></listitem>

      <listitem><para>/home &ndash; Настоятельно рекомендуется. Предоставьте общий
	  доступ к своему домашнему каталогу и пользовательским настройкам нескольким
	  дистрибутивам или сборкам LFS. Размер, как правило, довольно большой
	  и зависит от доступного места на диске.</para></listitem>

      <listitem><para>/usr &ndash; в LFS,
      <filename class="directory">/bin</filename>,
      <filename class="directory">/lib</filename>, и
      <filename class="directory">/sbin</filename> являются символическими
	  ссылками на их аналоги в <filename class="directory">/usr</filename>.
      Таким образом <filename class="directory">/usr</filename> содержит все
	  двоичные файлы, необходимые для работы системы. Для LFS отдельный раздел
      <filename class="directory">/usr</filename> не требуется. Если он
	  вам необходим, вы должны сделать раздел достаточно большим, чтобы
	  поместить туда все программы и библиотеки в системе. В этой конфигурации,
	  корневой раздел может быть очень маленьким (возможно, всего один
	  гигабайт), поэтому он подходит для тонкого клиента или бездисковой рабочей
	  станции (где <filename class="directory">/usr</filename> монтируется с
	  удаленного сервера). Однако вы должны знать, что для загрузки системы с 
	  отдельного раздела <filename class="directory">/usr</filename> потребуется 
	  initramfs (не включенный в LFS).</para></listitem>

      <listitem><para>/opt &ndash; Этот каталог наиболее полезен для BLFS,
	  в него можно установить некоторые большие пакеты, такие как KDE или Texlive,
	  без использования иерархии /usr. Для /opt достаточно размера от 5 до 10 гигабайт.</para>
      </listitem>

      <listitem revision='sysv'><para>/tmp &ndash; Отдельный раздел /tmp используется редко,
	  он полезен при настройке тонкого клиента. Обычно, его размер
	  не должен превышать пару гигабайт. Если у вас достаточно оперативной памяти, 
	  вы можете смонтировать /tmp как <systemitem class='filesystem'>tmpfs</systemitem>, чтобы 
	  ускорить доступ к временным файлам.</para></listitem>
	  
	  <listitem revision='systemd'><para>/tmp &ndash; По умолчанию, systemd 
	  монтирует здесь <systemitem class='filesystem'>tmpfs</systemitem>. Если 
	  вы хотите переопределить это поведение, следуйте инструкции
	  <xref linkend='systemd-no-tmpfs'/> при настройке системы LFS.</para></listitem>

      <listitem><para>/usr/src &ndash; Этот раздел очень удобен для хранения
	  исходников BLFS и совместного использования их в сборках LFS. Его
	  также можно использовать в качестве места для сборки пакетов BLFS. Размера
	  в 30-50 гигабайт вполне достаточно.</para></listitem>

    </itemizedlist>

    <para>Любой отдельный раздел, который вы хотите автоматически монтировать при загрузке,
	должен быть указан в файле <filename>/etc/fstab</filename>. Подробности о том, 
	как указать разделы, будут обсуждаться в <xref
    linkend="ch-bootable-fstab"/>.</para>

    </sect3>
  </sect2>
</sect1>
